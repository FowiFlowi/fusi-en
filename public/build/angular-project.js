"use strict";var app=angular.module("app",["ngMaterial","ngMessages","material.svgAssetsCache"]);app.controller("authController",["$scope","$http","users",function(e,t,n){e.firstClick=!1,e.buttonText="WhoAreYou?",e.who=function(){e.firstClick=!0,e.buttonText="ok",e.name&&e.pass&&t.post("/who",{name:e.name,pass:e.pass}).then(function(t){"wrong"!=t.data?(Object.assign(e.user,t.data),e.user.isAuth=!0,n.push(t.data)):e.wrong="Wrong password :c",e.pass=""})}}]),app.controller("listController",["$scope","$http","words",function(e,t,n){n.get().then(function(t){e.wordList=t,e.listLength=t.length,--e.loading.length||(e.loading.ready=!0,e.loading.displayStyle="inline")}),e.FABpressed=!1,e.buttonIcon="add",e.tabIndex=null,e.addWord=function(){if(e.tabIndex=e.userList.reduce(function(e,t){return e.concat(t.username)},[]).indexOf(e.user.username)+1,e.FABpressed=!0,e.buttonIcon="done",e.setHideFooter(!0),e.word&&e.translate){e.FABpressed=!1;var r={word:e.word,translate:e.translate,author:e.user.username,date:+new Date};t.post("/words",r).then(function(e){r._id=e.data,n.push(r)}),e.word="",e.translate="",e.buttonIcon="add",e.user.wordsAmount++,e.listLength++,e.setHideFooter(!1)}},e.deleteWord=function(r){var o=[];n.get().then(function(s){s.forEach(function(t){return t.author==e.user.username?o.push(t):""});var u="/words/"+o[r]._id;t.delete(u),n.remove(o[r]),e.user.wordsAmount--,e.listLength--})}}]),app.controller("mainController",["$scope","users",function(e,t){e.loading={ready:!1,length:2},e.hideFooter=!1,e.setHideFooter=function(t){return e.hideFooter=t},t.get().then(function(t){e.user=t.user,e.userList=t.list,--e.loading.length||(e.loading.ready=!0,e.loading.displayStyle="inline")})}]),app.directive("eventFocus",["focus",function(e){return function(t,n,r){n.on(r.eventFocus,function(){return e(r.eventFocusId)}),n.on("$destroy",function(){return element.off(r.eventFocus)})}}]),app.factory("focus",["$window","$timeout",function(e,t){return function(n){t(function(){var t=e.document.getElementById(n);t&&t.focus()})}}]),app.service("users",["$http","$q",function(e,t){var n=t.defer(),r=void 0,o=void 0;e.get("/who").then(function(e){return r=e.data,o=r[0]||{},r=r.slice(1),o.username?o.isAuth=!0:o.isAuth=!1,n.resolve({list:r,user:o})}).catch(function(e){return n.reject(e)}),this.get=function(){return n.promise},this.push=function(e){var t=!0;r.forEach(function(n){return n.username==e.username?t=!1:""}),t&&r.push(e)}}]),app.service("words",["$http","$q",function(e,t){var n=t.defer(),r=[];e.get("/words").then(function(e){r=e.data,n.resolve(r)}).catch(function(e){return n.reject(e)}),this.get=function(){return n.promise},this.push=function(e){return r.push(e)},this.remove=function(e){return r.forEach(function(t,n){return t._id==e._id?r.splice(n,1):""})}}]);